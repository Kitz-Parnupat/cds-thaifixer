<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../actions/commonAction.html">
<link rel="import" href="../../actions/authAction.html">
<link rel="import" href="../../redux-mixin.html">
<link rel="import" href="../../shared-styles.html">
<link rel="import" href="../../components/my-input/my-input.html">
<link rel="import" href="../../components/my-panel/my-panel.html">
<dom-module id="page-login">
    <template>
        <style include="shared-styles">
            .flex {
                height: 100vh;
                display: flex;
            }

            .flex-item {
                margin: auto;
                width: 400px;
                height: auto;
            }

            .header {
                color: var(--btn-color-primary-normal);
                text-align: center;
            }
            .content {
                padding: 0 1rem;
            }
            .footer {
                margin-top: 1rem;
                text-align: center;
            }
        </style>
        <div class="flex">
            <div class="flex-item">
                <my-panel box-shadow>
                    <div class="panel-header header">ThaiFixer.com</div>
                    <div class="content">
                        <paper-input label="Username" value="{{form.email}}"></paper-input>
                        <paper-input label="Password" type="password" value="{{form.password}}"></paper-input>
                        <br>
                        <paper-button class="btn-primary btn-md btn-full-width" on-tap="login">เข้าสู่ระบบ</paper-button>
                        <br>
                    </div>
                    <div class="footer textCenter">
                        ลืมรหัสผ่าน ?
                        <a href="#">click</a>
                    </div>
                </my-panel>
            </div>
            <!-- <h2>Login  [[message]]</h2>
            <label for="email">Email</label>
            <input type="text" id="email" value="test@hotmail.com">
            <label for="password">Password</label>
            <input type="password" id="password" value="Password">
            <button on-click="login">login</button>
            <div>
                status : [[status]]
            </div> -->
        </div>
    </template>

    <script>
        class pageLogin extends ReduxMixin(Polymer.Element) {
            static get is() {
                return 'page-login';
            }
            static get properties() {
                return {
                    form:{
                        type:Object,
                        value:{}
                    }
                };
            }
            ready() {
                super.ready();
                // common.setData('5999773e8ca0773d341666fe');
            }
            login() {
                auth.login(this.form)
                .then((res)=>auth.setLocalstorage(res.data.data))
                .then(()=>{My.changePage('blog')})
                .then(()=>{window.location.reload()})
            }
            checkUser() {
                var user = auth.getUser();
                this.dispatch({
                    type: 'AUTH_SET_USER',
                    payload: user
                })
            }
            clearUser() {
                auth.logout()
            }
        }

        window.customElements.define(pageLogin.is, pageLogin);
    </script>
</dom-module>