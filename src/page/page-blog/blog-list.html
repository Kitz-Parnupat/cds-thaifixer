<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/vaadin-material-theme/vaadin-grid.html">
<link rel="import" href="../../../bower_components/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../../components/my-vaadin-grid-style/my-vaadin-grid-style.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../shared-styles.html">
<link rel="import" href="../../actions/blogAction.html">
<link rel="import" href="../../redux-mixin.html">
<dom-module id="blog-list">
    <template>
        <style include="shared-styles">
        </style>

        <vaadin-grid class="vaadin-grid-material" items="[[list]]">

            <vaadin-grid-column width="100px" flex-grow="0">
                <template class="header">
                    <div style="text-align:center">#</div>
                </template>
                <template>
                    <div style="text-align:center">[[count(index)]]</div>
                </template>
            </vaadin-grid-column>

            <vaadin-grid-column>
                <template class="header">ชื่อบทความ</template>
                <template>[[item.blog_title]]</template>
            </vaadin-grid-column>

            <!-- <vaadin-grid-column>
                <template class="header">วันที่โพส</template>
                <template>[[item.created_at]]</template>
            </vaadin-grid-column> -->

            <vaadin-grid-column  width="150px" flex-grow="0">
                <template class="header">จัดการ</template>
                <template>
                    <paper-icon-button on-tap="editBlog" icon="create"></paper-icon-button>
                    <!-- <p style="white-space: normal">[[item.address.street]], [[item.address.city]]</p> -->
                </template>
            </vaadin-grid-column>

        </vaadin-grid>


    </template>

    <script>
        class blogList extends ReduxMixin(Polymer.Element) {

            static get is() {
                return 'blog-list';
            }

            static get properties() {
                return {
                    list:{
                        type:Array,
                        statePath:'blog.list'
                    }
                };
            }
            ready(){
                super.ready()
                blog.getBlog()
                .then((res)=> this.dispatch({type: 'GET_LIST_BLOG',payload: res.data.data}))
            }
            count(val){
                return val + 1;
            }
            editBlog(e){
                // console.log(e.model.item._id);
                blog.selectBlog(e.model.item._id)
                .then((res)=>this.dispatch({type: 'SELECT_BLOG',payload: res.data.data}))
                .then(()=>{My.changePage('content?id='+e.model.item._id)})
            }

        }

        window.customElements.define(blogList.is, blogList);
    </script>
</dom-module>